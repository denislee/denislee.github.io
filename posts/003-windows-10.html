<!DOCTYPE html><html lang="en"><head><meta name="robots" content="follow, index"/><meta name="description" content="um blog qualquer."/><meta property="og:site_name" content="denis lee | blog"/><meta property="og:description" content="um blog qualquer."/><meta property="og:title" content="denis lee | blog"/><meta property="og:image" content="https://assets.vercel.com/image/upload/q_auto/front/vercel/dps.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@denislee"/><meta name="twitter:title" content="denis lee | blog"/><meta name="twitter:description" content="um blog qualquer."/><meta name="twitter:image" content="https://assets.vercel.com/image/upload/q_auto/front/vercel/dps.png"/><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"/><link rel="preload" href="/fonts/Inter-roman.latin.var.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><title>Windows 10</title><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/4f095761bdcd0ca5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4f095761bdcd0ca5.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-49b6f2937c9ce9f4.js" defer=""></script><script src="/_next/static/chunks/framework-d5c96c6d07ca9fe9.js" defer=""></script><script src="/_next/static/chunks/main-be90e00a3c0a73d4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d4e301a789957741.js" defer=""></script><script src="/_next/static/chunks/947-21927187c7b6d424.js" defer=""></script><script src="/_next/static/chunks/pages/posts/003-windows-10-7f76a23dcc321987.js" defer=""></script><script src="/_next/static/b-3dyqzxk75zIyueoldr3/_buildManifest.js" defer=""></script><script src="/_next/static/b-3dyqzxk75zIyueoldr3/_ssgManifest.js" defer=""></script><script src="/_next/static/b-3dyqzxk75zIyueoldr3/_middlewareManifest.js" defer=""></script><style id="__jsx-7c359fde634f3543">a.jsx-7c359fde634f3543 {float:right}
@media screen and (max-width:480px) {article.jsx-7c359fde634f3543 {padding-top:2rem;
padding-bottom:4rem}}</style></head><body><div id="__next"><article class="container prose prose-sm md:prose"><div class="meta-line"><div class="meta"><time>Wed Sep 09 2020</time></div><a class="meta-back" href="/posts">Back</a></div><h1>Windows 10</h1><p>Depois de passar por muitos problemas com a conectividade do Windows 10, finalmente decidi fazer algo a respeito. Descobri através de alguns vídeos na internet que existe uma versão do Windows mais limpo, ou seja, sem todo o aparato de telemetría e spyware que a Microsoft deixa em seu sistema operacional.</p><p>Os videos que eu assisti foram:</p><p><em parentName="p">We fixed Windows 10 - Microsoft will HATE this!</em>
https://www.youtube.com/watch?v=nwkiU6GG-YU</p><p><em parentName="p">Windows 10 for Power Users – Private, Secure, Zero Bloatware (Windows 10 Ameliorated)</em>
https://www.youtube.com/watch?v=YTL0i5XzS7k</p><p>Tutorial escrito pelo Wolfgang
https://notthebe.ee/Windows10.html</p><p>E para facilitar, segui um híbrido de tutorial escrito do Wolfgang, quanto o vídeo dele. Ambos acabam complementando um ao outro. Mas, um parece nao funcionar sem o outro. Infelizmente.</p><p>Por esse motivo, estou deixando as minhas anotações da instalação aqui também. (Para futuros usos pessoais também.) Que basicamente será uma transcrição em português do que já foi escrito pelo Wolfgang.</p><h2>Resumo dos arquivos necessários</h2><ol><li parentName="ol">ISO do Windows 10 completo (peguei a versão Pro)</li><li parentName="ol">ISO do Linux (pode ser qualquer um)</li><li parentName="ol">Aplicação para calcular o SHA1 da imagem</li><li parentName="ol">Aplicação para criar um pendrive bootável</li><li parentName="ol">Atualização do Windows 10 cumulativo</li><li parentName="ol">Atualização do Windows 10 incremental</li><li parentName="ol">Amelioration Script</li><li parentName="ol">Backup dos seus Drivers</li><li parentName="ol">Hardentools (Security without borders)</li></ol><h2>NO WINDOWS</h2><h3>Download da imagem do Windows 10</h3><p>Faça download da imagem do Windows 10</p><p><strong parentName="p">Alternativa 1</strong> Baixar o aplicativo Fido (funciona apenas no Windows) https://github.com/pbatard/Fido</p><p><strong parentName="p">Alternativa 2</strong>: Selecionar no site https://tb.rg-adguard.net/public.php</p><p>No caso, eu peguei a versao em ingles e pro. Importante ressaltar que apenas nessa hora que você poderá escolher a língua do seu sistema operacional. Caso queira trocar futuramente, precisará reinstalar o Windows (acredito que você não queira fazer isso).</p><h3>Verificação da imagem do Windows 10</h3><p>Para verificar se a imagem do Windows que você acabou de baixar não está corrompida ou alterada, precisamos de uma aplicação para calcular o hash.</p><p><strong parentName="p">Alternativa 1</strong>: Utilização da ferramenta já existente no PowerShell</p><pre><code parentName="pre">Get-FileHash -Algorithm SHA1 Windows_2004.iso
</code></pre><p><strong parentName="p">Alternativa 2</strong>: https://www.adaic.org/resources/add_content/standards/articles/SHA-1.html</p><p>Executando alguma dessas duas alternativas, será possível comparar a saida desses programas no site: https://sha1.rg-adguard.net/</p><h3>Download dos updates</h3><p>Para isso você devera entrar no site o Windows 10 Update History: https://support.microsoft.com/en-us/help/4555932/windows-10-update-history</p><ol><li parentName="ol"><p parentName="li">Procurar a sua versão do Windows. na primeira coluna da esquerda.</p></li><li parentName="ol"><p parentName="li">Depois clique na primeiro item da segunda coluna na esquerda (In this release)</p></li><li parentName="ol"><p parentName="li">Copie o código do titulo da pagina KBXXXXXXX e va no site https://www.catalog.update.microsoft.com/Home.aspx e procure por esse código</p></li><li parentName="ol"><p parentName="li">Faça download da arquitetura do seu processador e para o seu Windows (cuidado para não baixar a versão para servidor)</p></li><li parentName="ol"><p parentName="li">Volte para a pagina onde você copiou o código (KBXXXXXXX) e procure pela palavra chave: <inlineCode parentName="p">the latest SSU</inlineCode></p></li><li parentName="ol"><p parentName="li">Copie o código que vem logo em seguida dessa palavra que você procurou e vá para o site e faça download (passos 3. e 4. anteriores)</p></li></ol><p>No fim, você terá baixado dois arquivos de atualização do Windows</p><h3>Download do script AME</h3><p><strong parentName="p">Alternativa 1</strong>: https://git.ameliorated.info/malte/scripts/releases/download/1903.2020.03.06/amelioration_1903_2020.03.06.bat</p><p>Caso o link esteja desatualizado. Entre no site https://ameliorated.info/documentation.html#ame_pre e procure pela palavra chave <inlineCode parentName="p">Windows 10 Amelioration script</inlineCode> e faça download</p><h3>Backup dos seus drivers</h3><p>Abra o PowerShell como Admin e execute o comando</p><pre><code parentName="pre">pnputil /export-driver * &quot;C:\backup-drivers&quot;
</code></pre><h3>Hora de baixar o Linux</h3><p>No tutorial ele (Wolfgang) recomendou baixar o xubuntu. Segui a recomendação, porém descobri na prática que qualquer imagem funciona. Poderia até ser um Arch, mas acredito que a recomendação foi mais pela facilidade de uso mesmo. A exigência para facilitar e que você consiga acessar a internet facilmente, consiga acessar o disco que o Windows será instalado, consiga acessar a Internet e tenha a modalidade de boot do Linux sem instalar o mesmo.</p><p>https://xubuntu.org/</p><h3>Criando um pendrive bootável</h3><p>Precisamos baixar um programa para gravar o ISO do Windows no pendrive e deixar ele bootável. Para isso recomendo você baixar o seguinte programa</p><p><strong parentName="p">Alternativa 1</strong>: https://rufus.ie/</p><p>Abra o Rufus e escolha o drive que está conectado o seu Pendrive, escolha a ISO do Windows e pronto.</p><h3>Copiando os arquivos</h3><p>Copie todos os arquivos que você baixou até agora para dentro do Pendrive. Segue a lista que deve entrar</p><ul><li parentName="ul">ISO do linux</li><li parentName="ul">Rufus</li><li parentName="ul">Atualizações do Windows</li><li parentName="ul">Script AME</li></ul><h3>Instalando o Windows</h3><p>Agora os passos para iniciar a instalação na sua máquina</p><ol><li parentName="ol">Conecte o Pendrive no seu computador</li><li parentName="ol">Reinicie o mesmo</li><li parentName="ol">Desative toda e qualquer conexão com a internet (wifi e ethernet) pela bios</li><li parentName="ol">Troque a ordem do boot para iniciar pelo pendrive</li><li parentName="ol">Talvez seja necessário desativar o boot de seguranca</li><li parentName="ol">Instale o Windows</li></ol><h2>NO WINDOWS (NOVO)</h2><h3>Primeiro boot no Windows</h3><p>Responda não para todas as perguntas de compartilhamento de informação que eles perguntarem durante o setup final da instalação do Windows.</p><p>Assim que você já estiver dentro do sistema operacional, faça as seguintes ações:</p><ul><li parentName="ul">Faca unpin em todos os aplicativos da barra de tarefas.</li><li parentName="ul">Faca unpin em todos os aplicativos do menu do botão iniciar.</li><li parentName="ul">Remova a barra de busca da barra de tarefas.</li></ul><h3>Instalação das atualizações</h3><p>Crie os seguintes diretórios no drive de onde foi instalado o Windows:</p><pre><code parentName="pre">- C:\SSU
- C:\Cumulative
</code></pre><p>Abra o PowerShell com permissão de administrador e dentro dele entre no drive do pendrive. E faça os seguintes comandos:</p><pre><code parentName="pre">expand -F:* name_of_the_ssu_package.msu C:\SSU
expand -F:* name_of_the_cumulative_package.msu C:\Cumulative
</code></pre><p>Em seguida faça o seguinte comando para instalar os pacotes descompactados</p><pre><code parentName="pre">dism /online /add-package /packagepath=C:\SSU\name_of_the_ssu.cab
</code></pre><p>Vai reiniciar apos a instalacao. Depois de reiniciado instale a atualização cumulativa</p><pre><code parentName="pre">dism /online /add-package /packagepath=C:\Cumulative\name_of_the_cumulative.cab
</code></pre><p>Reinicie duas vezes e agora execute o comando final</p><pre><code parentName="pre">dism /online /Cleanup-Image /StartComponentCleanup
</code></pre><h3>Executando o script AME</h3><p>Clique com o botão direito no script e execute como administrador.</p><p><strong parentName="p">Escolha 1</strong>: <inlineCode parentName="p">Run Pre-Amelioration</inlineCode></p><ul><li parentName="ul">Espere o processo terminar.</li></ul><p><strong parentName="p">Escolha 3</strong>: <inlineCode parentName="p">User Permissions</inlineCode></p><ul><li parentName="ul"><p parentName="li">Altere a senha de administrador.</p></li><li parentName="ul"><p parentName="li">Altere os privilégios do seu usuário local para <inlineCode parentName="p">Standard User</inlineCode></p></li></ul><p>Faça logout e logue novamente.</p><p>Abre um PowerShell como administrador e execute o comando para alterar a sua senha:</p><pre><code parentName="pre">net user &lt;seu-usuário&gt; *
</code></pre><h3>Criação do mídia de boot do Linux</h3><p>Abra o Rufus e escolha o pendrive e o ISO do Linux para transformar o seu pendrive que você acabou de usar para instalar o Windows para instalar o Linux.</p><p>Reinicie o computador com o pendrive conectado.</p><h2>NO LINUX</h2><h3>Dentro do Linux</h3><p>Nessa parte você já pode ligar novamente toda a conectividade do seu computador (que você havia desativado anteriormente na BIOS).</p><p>Entre no Linux pela escolha que não precisa instalar nada.</p><p>Abra um terminal e entre no diretório raiz da instalação do seu Windows e faça o seguinte comando:</p><pre><code parentName="pre">wget https://git.ameliorated.info/malte/scripts/releases/download/1903.2020.03.06/ameliorate_1903_2020.03.06.sh
</code></pre><p>(esse link pode estar desatualizado. Nesse caso entre no link: https://ameliorated.info/documentation.html e procure pela palavra chave <inlineCode parentName="p">Linux Ameliorate script</inlineCode> e copie o link)</p><p>Agora é só executar o script.</p><p>Caso tenha problemas em executar o script, faça os seguintes passo:</p><pre><code parentName="pre">sed -i &#x27;s/\r$//&#x27; &lt;script-shell&gt;
</code></pre><p>Agora é só executar o script que você acabou de baixar e aguardar.</p><p>Só reiniciar e voltar para o Windows.</p><h2>NO WINDOWS (NOVO)</h2><h3>Post-Amelioration</h3><p>Edite o script AME que você usou antes de entrar no Linux e procure pela seguinte linha:</p><pre><code parentName="pre">choco install -y --force --allow-empty-checksums firefox thunderbird vlc youtube-dl 7zip open-shell jpegview vcredist-all directx onlyoffice
</code></pre><p>E substitua para:</p><pre><code parentName="pre">choco install -y --force --allow-empty-checksums firefox thunderbird vlc youtube-dl 7zip open-shell  -installArgs ADDLOCAL=StartMenu jpegview vcredist-all directx libreoffice
</code></pre><p>Execute o script e escolha o Post-Amelioration</p><h3>Hardening Windows Settings</h3><p>Para ajudar na segurança, baixe e instale o Harden Tools.</p><p><strong parentName="p">Alternativa 1</strong>: https://securitywithoutborders.org/tools/hardentools.html</p><h3>Reinstalação dos drivers</h3><pre><code parentName="pre">pnputil.exe /add-driver C:\backup-drivers\*.inf /subdirs /install /reboot
</code></pre><small style="display:block;margin-top:8rem" class="jsx-7c359fde634f3543"><time class="jsx-7c359fde634f3543">2021</time> © denis lee.<a href="/feed.xml" class="jsx-7c359fde634f3543">RSS</a></small></article></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/posts/003-windows-10","query":{},"buildId":"b-3dyqzxk75zIyueoldr3","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>