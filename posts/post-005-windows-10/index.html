<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Windows 10, but better | Denis Lee</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="OlÃ¡,
Depois de um bom tempo longe e frustrado com a falta de ferramentas para publicar bem o blog (a limitaÃ§Ã£o do hugo para colocar facilmente imagens comparado aos outros blog atuais com muitas facilidades), acabou me afastando de escrever mais por aqui.
Mas, com a ajuda de alguns scrips, acredito que fique mais freqÃ¼ente as minha publicaÃ§Ãµes (e, quem sabe, do blog vire vÃ­deos novamente haha)
Atualmente estou utilizando mais o Instagram de redes sociais.">
<meta name="generator" content="Hugo 0.80.0" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />








  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">â†</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">Windows 10, but better</h1>

    <div class="tip">
        <span>
          Sep 9, 2020 00:00
        </span>
        <span class="split">
          Â·
        </span>
        <span>
          
            1208 words
          
        </span>
        <span class="split">
          Â·
        </span>
        <span>
          6 minute read
        </span>
    </div>

    <div class="content">
      <p>Depois de passar por muitos problemas com a conectividade do Windows 10, finalmente decidi fazer algo a respeito. Descobri atravÃ©s de alguns vÃ­deos na internet que existe uma versÃ£o do Windows mais limpo, ou seja, sem todo o aparato de telemetrÃ­a e spyware que a Microsoft deixa em seu sistema operacional.</p>
<p>Os videos que eu assisti foram:</p>
<p><em>We fixed Windows 10 - Microsoft will HATE this!</em>
<a href="https://www.youtube.com/watch?v=nwkiU6GG-YU">https://www.youtube.com/watch?v=nwkiU6GG-YU</a></p>
<p><em>Windows 10 for Power Users â€“ Private, Secure, Zero Bloatware (Windows 10 Ameliorated)</em>
<a href="https://www.youtube.com/watch?v=YTL0i5XzS7k">https://www.youtube.com/watch?v=YTL0i5XzS7k</a></p>
<p>Tutorial escrito pelo Wolfgang
<a href="https://notthebe.ee/Windows10.html">https://notthebe.ee/Windows10.html</a></p>
<p>E para facilitar, segui um hÃ­brido de tutorial escrito do Wolfgang, quanto o vÃ­deo dele. Ambos acabam complementando um ao outro. Mas, um parece nao funcionar sem o outro. Infelizmente.</p>
<p>Por esse motivo, estou deixando as minhas anotaÃ§Ãµes da instalaÃ§Ã£o aqui tambÃ©m. (Para futuros usos pessoais tambÃ©m.) Que basicamente serÃ¡ uma transcriÃ§Ã£o em portuguÃªs do que jÃ¡ foi escrito pelo Wolfgang.</p>
<h2 id="resumo-dos-arquivos-necessÃ¡rios">Resumo dos arquivos necessÃ¡rios <a href="#resumo-dos-arquivos-necess%c3%a1rios" class="anchor">ğŸ”—</a></h2><ol>
<li>ISO do Windows 10 completo (peguei a versÃ£o Pro)</li>
<li>ISO do Linux (pode ser qualquer um)</li>
<li>AplicaÃ§Ã£o para calcular o SHA1 da imagem</li>
<li>AplicaÃ§Ã£o para criar um pendrive bootÃ¡vel</li>
<li>AtualizaÃ§Ã£o do Windows 10 cumulativo</li>
<li>AtualizaÃ§Ã£o do Windows 10 incremental</li>
<li>Amelioration Script</li>
<li>Backup dos seus Drivers</li>
<li>Hardentools (Security without borders)</li>
</ol>
<h2 id="no-windows">NO WINDOWS <a href="#no-windows" class="anchor">ğŸ”—</a></h2><h3 id="download-da-imagem-do-windows-10">Download da imagem do Windows 10 <a href="#download-da-imagem-do-windows-10" class="anchor">ğŸ”—</a></h3><p>FaÃ§a download da imagem do Windows 10</p>
<p><strong>Alternativa 1</strong> Baixar o aplicativo Fido (funciona apenas no Windows) <a href="https://github.com/pbatard/Fido">https://github.com/pbatard/Fido</a></p>
<p><strong>Alternativa 2</strong>: Selecionar no site <a href="https://tb.rg-adguard.net/public.php">https://tb.rg-adguard.net/public.php</a></p>
<p>No caso, eu peguei a versao em ingles e pro. Importante ressaltar que apenas nessa hora que vocÃª poderÃ¡ escolher a lÃ­ngua do seu sistema operacional. Caso queira trocar futuramente, precisarÃ¡ reinstalar o Windows (acredito que vocÃª nÃ£o queira fazer isso).</p>
<h3 id="verificaÃ§Ã£o-da-imagem-do-windows-10">VerificaÃ§Ã£o da imagem do Windows 10 <a href="#verifica%c3%a7%c3%a3o-da-imagem-do-windows-10" class="anchor">ğŸ”—</a></h3><p>Para verificar se a imagem do Windows que vocÃª acabou de baixar nÃ£o estÃ¡ corrompida ou alterada, precisamos de uma aplicaÃ§Ã£o para calcular o hash.</p>
<p><strong>Alternativa 1</strong>: UtilizaÃ§Ã£o da ferramenta jÃ¡ existente no PowerShell</p>
<pre><code>Get-FileHash -Algorithm SHA1 Windows_2004.iso
</code></pre><p><strong>Alternativa 2</strong>: <a href="https://www.adaic.org/resources/add_content/standards/articles/SHA-1.html">https://www.adaic.org/resources/add_content/standards/articles/SHA-1.html</a></p>
<p>Executando alguma dessas duas alternativas, serÃ¡ possÃ­vel comparar a saida desses programas no site: <a href="https://sha1.rg-adguard.net/">https://sha1.rg-adguard.net/</a></p>
<h3 id="download-dos-updates">Download dos updates <a href="#download-dos-updates" class="anchor">ğŸ”—</a></h3><p>Para isso vocÃª devera entrar no site o Windows 10 Update History: <a href="https://support.microsoft.com/en-us/help/4555932/windows-10-update-history">https://support.microsoft.com/en-us/help/4555932/windows-10-update-history</a></p>
<ol>
<li>
<p>Procurar a sua versÃ£o do Windows. na primeira coluna da esquerda.</p>
</li>
<li>
<p>Depois clique na primeiro item da segunda coluna na esquerda (In this release)</p>
</li>
<li>
<p>Copie o cÃ³digo do titulo da pagina KBXXXXXXX e va no site <a href="https://www.catalog.update.microsoft.com/Home.aspx">https://www.catalog.update.microsoft.com/Home.aspx</a> e procure por esse cÃ³digo</p>
</li>
<li>
<p>FaÃ§a download da arquitetura do seu processador e para o seu Windows (cuidado para nÃ£o baixar a versÃ£o para servidor)</p>
</li>
<li>
<p>Volte para a pagina onde vocÃª copiou o cÃ³digo (KBXXXXXXX) e procure pela palavra chave: <code>the latest SSU</code></p>
</li>
<li>
<p>Copie o cÃ³digo que vem logo em seguida dessa palavra que vocÃª procurou e vÃ¡ para o site e faÃ§a download (passos 3. e 4. anteriores)</p>
</li>
</ol>
<p>No fim, vocÃª terÃ¡ baixado dois arquivos de atualizaÃ§Ã£o do Windows</p>
<h3 id="download-do-script-ame">Download do script AME <a href="#download-do-script-ame" class="anchor">ğŸ”—</a></h3><p><strong>Alternativa 1</strong>: <a href="https://git.ameliorated.info/malte/scripts/releases/download/1903.2020.03.06/amelioration_1903_2020.03.06.bat">https://git.ameliorated.info/malte/scripts/releases/download/1903.2020.03.06/amelioration_1903_2020.03.06.bat</a></p>
<p>Caso o link esteja desatualizado. Entre no site <a href="https://ameliorated.info/documentation.html#ame_pre">https://ameliorated.info/documentation.html#ame_pre</a> e procure pela palavra chave <code>Windows 10 Amelioration script</code> e faÃ§a download</p>
<h3 id="backup-dos-seus-drivers">Backup dos seus drivers <a href="#backup-dos-seus-drivers" class="anchor">ğŸ”—</a></h3><p>Abra o PowerShell como Admin e execute o comando</p>
<pre><code>pnputil /export-driver * &quot;C:\backup-drivers&quot;
</code></pre><h3 id="hora-de-baixar-o-linux">Hora de baixar o Linux <a href="#hora-de-baixar-o-linux" class="anchor">ğŸ”—</a></h3><p>No tutorial ele (Wolfgang) recomendou baixar o xubuntu. Segui a recomendaÃ§Ã£o, porÃ©m descobri na prÃ¡tica que qualquer imagem funciona. Poderia atÃ© ser um Arch, mas acredito que a recomendaÃ§Ã£o foi mais pela facilidade de uso mesmo. A exigÃªncia para facilitar e que vocÃª consiga acessar a internet facilmente, consiga acessar o disco que o Windows serÃ¡ instalado, consiga acessar a Internet e tenha a modalidade de boot do Linux sem instalar o mesmo.</p>
<p><a href="https://xubuntu.org/">https://xubuntu.org/</a></p>
<h3 id="criando-um-pendrive-bootÃ¡vel">Criando um pendrive bootÃ¡vel <a href="#criando-um-pendrive-boot%c3%a1vel" class="anchor">ğŸ”—</a></h3><p>Precisamos baixar um programa para gravar o ISO do Windows no pendrive e deixar ele bootÃ¡vel. Para isso recomendo vocÃª baixar o seguinte programa</p>
<p><strong>Alternativa 1</strong>: <a href="https://rufus.ie/">https://rufus.ie/</a></p>
<p>Abra o Rufus e escolha o drive que estÃ¡ conectado o seu Pendrive, escolha a ISO do Windows e pronto.</p>
<h3 id="copiando-os-arquivos">Copiando os arquivos <a href="#copiando-os-arquivos" class="anchor">ğŸ”—</a></h3><p>Copie todos os arquivos que vocÃª baixou atÃ© agora para dentro do Pendrive. Segue a lista que deve entrar</p>
<ul>
<li>ISO do linux</li>
<li>Rufus</li>
<li>AtualizaÃ§Ãµes do Windows</li>
<li>Script AME</li>
</ul>
<h3 id="instalando-o-windows">Instalando o Windows <a href="#instalando-o-windows" class="anchor">ğŸ”—</a></h3><p>Agora os passos para iniciar a instalaÃ§Ã£o na sua mÃ¡quina</p>
<ol>
<li>Conecte o Pendrive no seu computador</li>
<li>Reinicie o mesmo</li>
<li>Desative toda e qualquer conexÃ£o com a internet (wifi e ethernet) pela bios</li>
<li>Troque a ordem do boot para iniciar pelo pendrive</li>
<li>Talvez seja necessÃ¡rio desativar o boot de seguranca</li>
<li>Instale o Windows</li>
</ol>
<h2 id="no-windows-novo">NO WINDOWS (NOVO) <a href="#no-windows-novo" class="anchor">ğŸ”—</a></h2><h3 id="primeiro-boot-no-windows">Primeiro boot no Windows <a href="#primeiro-boot-no-windows" class="anchor">ğŸ”—</a></h3><p>Responda nÃ£o para todas as perguntas de compartilhamento de informaÃ§Ã£o que eles perguntarem durante o setup final da instalaÃ§Ã£o do Windows.</p>
<p>Assim que vocÃª jÃ¡ estiver dentro do sistema operacional, faÃ§a as seguintes aÃ§Ãµes:</p>
<ul>
<li>Faca unpin em todos os aplicativos da barra de tarefas.</li>
<li>Faca unpin em todos os aplicativos do menu do botÃ£o iniciar.</li>
<li>Remova a barra de busca da barra de tarefas.</li>
</ul>
<h3 id="instalaÃ§Ã£o-das-atualizaÃ§Ãµes">InstalaÃ§Ã£o das atualizaÃ§Ãµes <a href="#instala%c3%a7%c3%a3o-das-atualiza%c3%a7%c3%b5es" class="anchor">ğŸ”—</a></h3><p>Crie os seguintes diretÃ³rios no drive de onde foi instalado o Windows:</p>
<pre><code>- C:\SSU
- C:\Cumulative
</code></pre><p>Abra o PowerShell com permissÃ£o de administrador e dentro dele entre no drive do pendrive. E faÃ§a os seguintes comandos:</p>
<pre><code>expand -F:* name_of_the_ssu_package.msu C:\SSU
expand -F:* name_of_the_cumulative_package.msu C:\Cumulative
</code></pre><p>Em seguida faÃ§a o seguinte comando para instalar os pacotes descompactados</p>
<pre><code>dism /online /add-package /packagepath=C:\SSU\name_of_the_ssu.cab
</code></pre><p>Vai reiniciar apos a instalacao. Depois de reiniciado instale a atualizaÃ§Ã£o cumulativa</p>
<pre><code>dism /online /add-package /packagepath=C:\Cumulative\name_of_the_cumulative.cab
</code></pre><p>Reinicie duas vezes e agora execute o comando final</p>
<pre><code>dism /online /Cleanup-Image /StartComponentCleanup
</code></pre><h3 id="executando-o-script-ame">Executando o script AME <a href="#executando-o-script-ame" class="anchor">ğŸ”—</a></h3><p>Clique com o botÃ£o direito no script e execute como administrador.</p>
<p><strong>Escolha 1</strong>: <code>Run Pre-Amelioration</code></p>
<ul>
<li>Espere o processo terminar.</li>
</ul>
<p><strong>Escolha 3</strong>: <code>User Permissions</code></p>
<ul>
<li>
<p>Altere a senha de administrador.</p>
</li>
<li>
<p>Altere os privilÃ©gios do seu usuÃ¡rio local para <code>Standard User</code></p>
</li>
</ul>
<p>FaÃ§a logout e logue novamente.</p>
<p>Abre um PowerShell como administrador e execute o comando para alterar a sua senha:</p>
<pre><code>net user &lt;seu-usuÃ¡rio&gt; *
</code></pre><h3 id="criaÃ§Ã£o-do-mÃ­dia-de-boot-do-linux">CriaÃ§Ã£o do mÃ­dia de boot do Linux <a href="#cria%c3%a7%c3%a3o-do-m%c3%addia-de-boot-do-linux" class="anchor">ğŸ”—</a></h3><p>Abra o Rufus e escolha o pendrive e o ISO do Linux para transformar o seu pendrive que vocÃª acabou de usar para instalar o Windows para instalar o Linux.</p>
<p>Reinicie o computador com o pendrive conectado.</p>
<h2 id="no-linux">NO LINUX <a href="#no-linux" class="anchor">ğŸ”—</a></h2><h3 id="dentro-do-linux">Dentro do Linux <a href="#dentro-do-linux" class="anchor">ğŸ”—</a></h3><p>Nessa parte vocÃª jÃ¡ pode ligar novamente toda a conectividade do seu computador (que vocÃª havia desativado anteriormente na BIOS).</p>
<p>Entre no Linux pela escolha que nÃ£o precisa instalar nada.</p>
<p>Abra um terminal e entre no diretÃ³rio raiz da instalaÃ§Ã£o do seu Windows e faÃ§a o seguinte comando:</p>
<pre><code>wget https://git.ameliorated.info/malte/scripts/releases/download/1903.2020.03.06/ameliorate_1903_2020.03.06.sh
</code></pre><p>(esse link pode estar desatualizado. Nesse caso entre no link: <a href="https://ameliorated.info/documentation.html">https://ameliorated.info/documentation.html</a> e procure pela palavra chave <code>Linux Ameliorate script</code> e copie o link)</p>
<p>Agora Ã© sÃ³ executar o script.</p>
<p>Caso tenha problemas em executar o script, faÃ§a os seguintes passo:</p>
<pre><code>sed -i 's/\r$//' &lt;script-shell&gt;
</code></pre><p>Agora Ã© sÃ³ executar o script que vocÃª acabou de baixar e aguardar.</p>
<p>SÃ³ reiniciar e voltar para o Windows.</p>
<h2 id="no-windows-novo-1">NO WINDOWS (NOVO) <a href="#no-windows-novo-1" class="anchor">ğŸ”—</a></h2><h3 id="post-amelioration">Post-Amelioration <a href="#post-amelioration" class="anchor">ğŸ”—</a></h3><p>Edite o script AME que vocÃª usou antes de entrar no Linux e procure pela seguinte linha:</p>
<pre><code>choco install -y --force --allow-empty-checksums firefox thunderbird vlc youtube-dl 7zip open-shell jpegview vcredist-all directx onlyoffice
</code></pre><p>E substitua para:</p>
<pre><code>choco install -y --force --allow-empty-checksums firefox thunderbird vlc youtube-dl 7zip open-shell  -installArgs ADDLOCAL=StartMenu jpegview vcredist-all directx libreoffice
</code></pre><p>Execute o script e escolha o Post-Amelioration</p>
<h3 id="hardening-windows-settings">Hardening Windows Settings <a href="#hardening-windows-settings" class="anchor">ğŸ”—</a></h3><p>Para ajudar na seguranÃ§a, baixe e instale o Harden Tools.</p>
<p><strong>Alternativa 1</strong>: <a href="https://securitywithoutborders.org/tools/hardentools.html">https://securitywithoutborders.org/tools/hardentools.html</a></p>
<h3 id="reinstalaÃ§Ã£o-dos-drivers">ReinstalaÃ§Ã£o dos drivers <a href="#reinstala%c3%a7%c3%a3o-dos-drivers" class="anchor">ğŸ”—</a></h3><pre><code>pnputil.exe /add-driver C:\backup-drivers\*.inf /subdirs /install /reboot
</code></pre>
    </div>

    
        <div class="tags">
            
                <a href="https://denislee.github.io/tags/untagged">untagged</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    

    <p class="copyright">
    
       Â© Copyright 
       2021 
       <span class="split">
        <svg fill="#bbbbbb" width="15" height="15" version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">
  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>
</svg>
       </span>
       
    
    </p>
    <p class="powerby">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
    </p>
</footer>

  </body>
</html>
